# System Architecture

## Компоненты
- **Mobile (Flutter):** UI, офлайн-кеш, очередь синхронизации, пуши.
- **Backend API:** Auth, Tasks, Calendar, Goals, Finance, Notifications, Feature Flags.
- **AI Service:** планирование недели, подсказки целей, резюме недели, тональная коррекция писем.
- **Data Layer:** PostgreSQL + Redis (кеш/сессии) + S3-хранилище.
- **Async:** очередь (RabbitMQ/Redis Streams) + воркеры для синхронизаций, AI, интеграций.
- **Monitoring:** Grafana/Prometheus, Sentry, Crashlytics.

## Потоки данных (упрощённо)
1. Пользователь создаёт задачу в приложении → сохраняется локально → синхронизируется на сервер через `/tasks` → фоновые воркеры пушат напоминания.
2. Импорт из Google Calendar: backend-воркер получает вебхук, обновляет события, отправляет пуш об изменениях.
3. AI-планирование: backend формирует контекст (цели, расписание), отправляет в AI сервис, получает расписание и пишет в таблицу `ai_plans` + задачи.

## Нефункциональные аспекты
- Горизонтальное масштабирование API и воркеров, sticky-сессии не требуются (stateless).
- Кеширование справочников и результатов AI на 24 часа.
- Резервное копирование БД ежедневно, тест восстановления еженедельно.
