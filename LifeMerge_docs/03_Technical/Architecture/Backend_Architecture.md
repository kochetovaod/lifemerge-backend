# Backend Architecture

## Модули
- **Auth:** регистрация, вход, refresh, устройства, роли.
- **Tasks/Goals:** CRUD, подзадачи, напоминания, статусы, прогресс целей.
- **Calendar:** события, повторения, синхронизация с внешними календарями.
- **Finance:** транзакции, категории, бюджеты, отчёты.
- **Inbox:** сбор уведомлений/входящих идей с конвертацией в задачи/события.
- **Notifications:** пуши/почта, расписания триггеров.

## Технологии
- REST API (FastAPI/Express), PostgreSQL, Redis для кеша и сессий, Celery/BullMQ для очередей.
- Авторизация через JWT, rate-limit middleware, OpenAPI спецификация генерируется автоматически.
- Модульная монолитная структура или микросервисы (Auth+Core, AI отдельный) в зависимости от нагрузки.

## Паттерны
- DTO ↔ Domain мапперы, репозитории для БД, сервисы с бизнес-логикой.
- Idempotency для POST/PATCH/DELETE, optimistic locking с `updated_at`.
- Вебхуки для синхронизации календарей, retry с экспоненциальной задержкой.

## Масштабирование
- API горизонтально за балансером; воркеры масштабируются по метрикам очереди.
- Кеширование справочников и публичных настроек; heavy-вычисления в воркерах.
- Фичефлаги для дорогих функций (AI, интеграции) и для миграций данных.
